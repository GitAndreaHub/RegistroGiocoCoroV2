<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Prototype GiocoCoro UI</title>
  <!-- Tailwind CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; background: #f9f9f9; margin: 0; }
    #root { max-width: 600px; margin: 0 auto; padding: 1rem; padding-bottom: 4rem; position: relative; }
    .input-group { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
    input[type="date"], input[type="text"] {
      flex: 1;
      padding: 0.5rem 0.75rem;
      font-size: 1rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
    }
    button {
      transition: all 0.2s ease-in-out;
    }
    .btn-add { background-color: #d946ef; color: white; padding: 0.6rem 1.2rem; border-radius: 0.375rem; font-weight: 600; }
    .btn-add:active { transform: scale(0.98); }
    .status-btn { padding: 0.5rem 1rem; border-radius: 9999px; font-weight: 600; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: transform 0.2s ease; }
    .status-btn.default { background-color: #e5e7eb; color: #374151; }
    .status-btn.present { background-color: #10b981; color: white; }
    .status-btn.absent { background-color: #ef4444; color: white; }
    .status-btn:hover { transform: scale(1.05); }
    .delete-btn { color: #e11d48; background: none; border: none; cursor: pointer; padding: 0.25rem; }
    .delete-btn:hover { background-color: #fee2e2; border-radius: 0.375rem; }
    .student-item { background: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; gap: 1rem; margin-bottom: 1rem; animation: slideDownFade 0.3s ease both; }
    .modal-backdrop { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); display:flex; justify-content:center; align-items:center; }
    .modal { background:white; padding:1.5rem; border-radius:0.5rem; border-top:4px solid #d946ef; box-shadow:0 25px 50px -12px rgba(0,0,0,0.25); }
    .btn-confirm { background-color:#ef4444; color:white; padding:0.5rem 1rem; border-radius:0.375rem; margin-right:0.5rem; }
    .btn-cancel { background-color:#9ca3af; color:white; padding:0.5rem 1rem; border-radius:0.375rem; }
    @keyframes slideDownFade { from { opacity:0; transform: translateY(-10px);} to { opacity:1; transform: translateY(0);} }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React & Firebase -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore-compat.js"></script>
  <script>
    // Firebase init
    const firebaseConfig = {
      apiKey: "AIzaSyA4TzdjNP4roonlqd9Pz5Nebs7Q2xQjcOo",
      authDomain: "registro-giococoro-v2.firebaseapp.com",
      projectId: "registro-giococoro-v2",
      storageBucket: "registro-giococoro-v2.firebasestorage.app",
      messagingSenderId: "241025435819",
      appId: "1:241025435819:web:081adbe21b592a0eda8fee"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
  <script>
    (function() {
      const { useState, useEffect } = React;
      function App() {
        const today = new Date().toISOString().split('T')[0];
        const [students, setStudents] = useState([]);
        const [newName, setNewName] = useState('');

        useEffect(() => {
          db.collection('students').get().then(snap => {
            setStudents(snap.docs.map(d => d.data().name));
          });
        }, []);

        const addStudent = () => {
          const name = newName.trim(); if (!name) return;
          db.collection('students').add({ name }).then(() => {
            setStudents(prev => [...prev, name]);
            setNewName('');
          });
        };

        const deleteStudent = (name) => {
          db.collection('students').where('name','==',name).get().then(snap => {
            snap.forEach(doc => doc.ref.delete());
            setStudents(prev => prev.filter(n=>n!==name));
          });
        };

        return React.createElement('div', {},
          React.createElement('div',{className:'input-group'},
            React.createElement('input',{type:'date',value:today,readOnly:true}),
            React.createElement('input',{type:'text',placeholder:'Nuovo studente',value:newName,onChange:e=>setNewName(e.target.value)}),
            React.createElement('button',{className:'btn-add',onClick:addStudent},'Aggiungi')
          ),
          students.map(name=>React.createElement('div',{key:name,className:'student-item'},
            React.createElement('span',null,name),
            React.createElement('div',{},
              React.createElement('button',{className:`status-btn default`},'Non definito'),
              React.createElement('button',{className:'delete-btn',onClick:()=>deleteStudent(name)},'×')
            )
          ))
        );
      }
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(App));
    })();
  </script>
  <!-- Register Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(() => console.log('👍 SW registrato'))
        .catch(err=>console.error('SW error',err));
    }
  </script>
</body>
</html>
